external get_balance : [%stack: address] -> [%stack: tez] = "GET_BALANCE"
external block_level : unit -> [%stack: nat] = "BLOCK_LEVEL"
external is_implicit : [%stack: address] -> [%stack: key_hash option] = "IS_IMPLICIT"
external get_storage : [%type: 'a] -> [%stack: address] -> [%stack: 'a option] = "GET_STORAGE"
external reveal : [%stack: address] -> [%stack: key] -> [%stack: operation] = "REVEAL"
external increase_balance : [%stack: tez] -> unit = "INCREASE_BALANCE" [@@effect]
external test_fail : [%stack: 'a] -> unit = "FAILWITH" [@@effect]

let [@noinline] w = 1p

type t = A | B

let [@noinline] f (x : nat) =
  match (A : t) with
  | A -> x + w
  | B -> failwith A
